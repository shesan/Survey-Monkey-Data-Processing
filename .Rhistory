id_variables
# question_variables <- colnames(Survey_Monkey_2)[11:length()]
Survey_Monkey_Melt <- melt(Survey_Monkey_2, id = id_variables, variable.name = "Question", value.name = "Answer")
View(Survey_Monkey_Melt)
Survey_Monkey_Question <- read_excel("Data - Survey Monkey Output (Edited).xlsx", sheet = "Questions")
Survey_Monkey_Question_2 <- Survey_Monkey_Question
# colnames(Survey_Monkey_Question_2)
Survey_Monkey_Question_2 <- Survey_Monkey_Question_2[, !names(Survey_Monkey_Question_2) %in% c("Raw_Question", "Raw_Subquestion", "...3", "Question", "Subquestion", "Question & Subquestion...6")]
Survey_Monkey_Question_2 <- rename(Survey_Monkey_Question_2, "Question" = "Question & Subquestion...7")
# colnames(Survey_Monkey_Question_2)
#Merge and remove NA
Survey_Monkey_Merged <- merge(Survey_Monkey_Melt, Survey_Monkey_Question_2, by.x = "Question", by.y = "Question", all.x = TRUE)
respondents <- Survey_Monkey_Merged[! is.na(Survey_Monkey_Merged$Answer),]
# respondents_2 <- respondents
respondents <- respondents[, (number_of_unique_answers = length(unique("Respondent ID")))]
respondents
#Merge and remove NA
Survey_Monkey_Merged <- merge(Survey_Monkey_Melt, Survey_Monkey_Question_2, by.x = "Question", by.y = "Question", all.x = TRUE)
respondents <- Survey_Monkey_Merged[! is.na(Survey_Monkey_Merged$Answer),]
respondents
Survey_Monkey_Merged
#Merge and remove NA
Survey_Monkey_Merged <- merge(Survey_Monkey_Melt, Survey_Monkey_Question_2, by.x = "Question", by.y = "Question", all.x = TRUE)
respondents <- Survey_Monkey_Merged[! is.na(Survey_Monkey_Merged$Answer),]
Survey_Monkey_Merged
respondents
length(unique("Respondent ID")
)
length(unique(respondents$`Respondent ID`))
(unique(respondents$`Respondent ID`))
# respondents_2 <- respondents
respondents <- respondents[, (number_of_unique_answers = length(unique("Respondent ID")))]
# respondents
respondents
view(respondents)
# respondents_2 <- respondents
respondents <- respondents[, .(number_of_unique_answers = length(unique("Respondent ID")))]
# respondents_2 <- respondents
respondents <- respondents[, (number_of_unique_answers = length(unique("Respondent ID")))]
#Merge and remove NA
Survey_Monkey_Merged <- merge(Survey_Monkey_Melt, Survey_Monkey_Question_2, by.x = "Question", by.y = "Question", all.x = TRUE)
respondents <- Survey_Monkey_Merged[! is.na(Survey_Monkey_Merged$Answer),]
# respondents_2 <- respondents
respondents <- respondents[, .(number_of_unique_answers = length(unique("Respondent ID")))]
# respondents_2 <- respondents
respondents <- respondents[, (number_of_unique_answers = length(unique("Respondent ID")))]
# respondents
# respondents_2 <- respondents
DT <- data.table(respondents)
respondents <- DT[, (number_of_unique_answers = length(unique("Respondent ID")))]
# respondents
respondents
respondents <- DT[, (number_of_unique_answers = length(unique("Respondent ID"))), by="Question"]
#Merge and remove NA
Survey_Monkey_Merged <- merge(Survey_Monkey_Melt, Survey_Monkey_Question_2, by.x = "Question", by.y = "Question", all.x = TRUE)
respondents <- Survey_Monkey_Merged[! is.na(Survey_Monkey_Merged$Answer),]
# respondents_2 <- respondents
DT <- data.table(respondents)
respondents <- DT[, (number_of_unique_answers = length(unique("Respondent ID"))), by="Question"]
respondents
respondents <- DT[, .(number_of_unique_answers = length(unique("Respondent ID"))), by="Question"]
respondents
respondents
#Merge and remove NA
Survey_Monkey_Merged <- merge(Survey_Monkey_Melt, Survey_Monkey_Question_2, by.x = "Question", by.y = "Question", all.x = TRUE)
respondents <- Survey_Monkey_Merged[! is.na(Survey_Monkey_Merged$Answer),]
# respondents_2 <- respondents
respondents <- respondents[, .(number_of_unique_answers = length(unique("Respondent ID"))), by="Question"]
# respondents_2 <- respondents
respondents <- respondents[, .(number_of_unique_answers = length(unique("Respondent ID"))), by="Question"]
respondents
# respondents_2 <- respondents
tmp <- data.table(respondents)
respondents <- tmp[, .(number_of_unique_answers = length(unique("Respondent ID"))), by="Question"]
respondents
tmp
# respondents_2 <- respondents
tmp <- data.table(respondents)
respondents <- tmp[, .(number_of_unique_answers = length(unique("Respondent ID"))), group_by ="Question"]
respondents <- tmp[, .(number_of_unique_answers = length(unique("Respondent ID"))), by ="Question"]
tmp
# respondents_2 <- respondents
tmp <- data.table(respondents)
respondents <- tmp[, .(number_of_unique_answers = length(unique("Respondent ID"))), by ="Question"]
tmp
#Merge and remove NA
Survey_Monkey_Merged <- merge(Survey_Monkey_Melt, Survey_Monkey_Question_2, by.x = "Question", by.y = "Question", all.x = TRUE)
respondents <- Survey_Monkey_Merged[! is.na(Survey_Monkey_Merged$Answer),]
# respondents_2 <- respondents
tmp <- data.table(respondents)
respondents <- tmp[, .(number_of_unique_answers = length(unique("Respondent ID"))), by ="Question"]
tmp
respondents
length(unique("Respondent ID")
)
length(unique("Respondent ID"))
(unique("Respondent ID"))
respondents
#Merge and remove NA
Survey_Monkey_Merged <- merge(Survey_Monkey_Melt, Survey_Monkey_Question_2, by.x = "Question", by.y = "Question", all.x = TRUE)
View(Survey_Monkey)
View(Survey_Monkey_Merged)
# colnames(Survey_Monkey_Question_2)
Survey_Monkey_Question_2 <- Survey_Monkey_Question_2[, !names(Survey_Monkey_Question_2) %in% c("Raw_Question", "Raw_Subquestion", "...3", "Question", "Subquestion", "Question & Subquestion...6")]
Survey_Monkey_Question_2 <- rename(Survey_Monkey_Question_2, "Question" = "Question & Subquestion...7")
library(readxl)
library(reshape2)
library(data.table)
library(writexl)
library(dplyr)
Survey_Monkey <- read_excel("Data - Survey Monkey Output (Edited).xlsx", sheet = "Edited_Data")
Survey_Monkey_2 <- (Survey_Monkey)
View(Survey_Monkey)
View(Survey_Monkey_2)
col_drop <- c("Email Address", "First Name", "Last Name", "Custom Data 1")
Survey_Monkey_2 <- Survey_Monkey_2[, !names(Survey_Monkey_2) %in% col_drop]
id_variables <- colnames(Survey_Monkey_2)[1:10]
id_variables
# question_variables <- colnames(Survey_Monkey_2)[11:length()]
Survey_Monkey_Melt <- melt(Survey_Monkey_2, id = id_variables, variable.name = "Question", value.name = "Answer")
View(Survey_Monkey_Melt)
Survey_Monkey_Question <- read_excel("Data - Survey Monkey Output (Edited).xlsx", sheet = "Questions")
Survey_Monkey_Question_2 <- Survey_Monkey_Question
# colnames(Survey_Monkey_Question_2)
Survey_Monkey_Question_2 <- Survey_Monkey_Question_2[, !names(Survey_Monkey_Question_2) %in% c("Raw_Question", "Raw_Subquestion", "...3", "Question", "Subquestion", "Question & Subquestion...6")]
Survey_Monkey_Question_2 <- rename(Survey_Monkey_Question_2, "Question" = "Question & Subquestion...7")
# colnames(Survey_Monkey_Question_2)
#Merge and remove NA
Survey_Monkey_Merged <- merge(Survey_Monkey_Melt, Survey_Monkey_Question_2, by.x = "Question", by.y = "Question", all.x = TRUE)
respondents <- Survey_Monkey_Merged[! is.na(Survey_Monkey_Merged$Answer),]
# respondents_2 <- respondents
tmp <- data.table(respondents)
respondents <- tmp[, .(number_of_unique_answers = length(unique("Respondent ID"))), by ="Question"]
tmp
respondents
View(Survey_Monkey_Melt)
# colnames(Survey_Monkey_Question_2)
Survey_Monkey_Question_2 <- Survey_Monkey_Question_2[, !names(Survey_Monkey_Question_2) %in% c("Raw_Question", "Raw_Subquestion", "...3", "Question & Subquestion...6")]
Survey_Monkey_Question_2 <- rename(Survey_Monkey_Question_2, "Questionsub" = "Question & Subquestion...7")
library(readxl)
library(readxl)
library(reshape2)
library(data.table)
library(writexl)
library(dplyr)
Survey_Monkey <- read_excel("Data - Survey Monkey Output (Edited).xlsx", sheet = "Edited_Data")
Survey_Monkey_2 <- (Survey_Monkey)
View(Survey_Monkey)
View(Survey_Monkey_2)
col_drop <- c("Email Address", "First Name", "Last Name", "Custom Data 1")
Survey_Monkey_2 <- Survey_Monkey_2[, !names(Survey_Monkey_2) %in% col_drop]
id_variables <- colnames(Survey_Monkey_2)[1:10]
id_variables
# question_variables <- colnames(Survey_Monkey_2)[11:length()]
Survey_Monkey_Melt <- melt(Survey_Monkey_2, id = id_variables, variable.name = "Question", value.name = "Answer")
View(Survey_Monkey_Melt)
Survey_Monkey_Question <- read_excel("Data - Survey Monkey Output (Edited).xlsx", sheet = "Questions")
Survey_Monkey_Question_2 <- Survey_Monkey_Question
# colnames(Survey_Monkey_Question_2)
Survey_Monkey_Question_2 <- Survey_Monkey_Question_2[, !names(Survey_Monkey_Question_2) %in% c("Raw_Question", "Raw_Subquestion", "...3", "Question & Subquestion...6")]
Survey_Monkey_Question_2 <- rename(Survey_Monkey_Question_2, "Questionsub" = "Question & Subquestion...7")
# colnames(Survey_Monkey_Question_2)
View(Survey_Monkey_Question_2)
#Merge and remove NA
Survey_Monkey_Merged <- merge(Survey_Monkey_Melt, Survey_Monkey_Question_2, by.x = "Question", by.y = "Questionsub", all.x = TRUE)
respondents <- Survey_Monkey_Merged[! is.na(Survey_Monkey_Merged$Answer),]
View(respondents)
# respondents_2 <- respondents
tmp <- data.table(respondents)
respondents <- tmp[, .(number_of_unique_answers = length(unique("Respondent ID"))), by ="Question"]
tmp
respondents
View(respondents)
#Merge and remove NA
Survey_Monkey_Merged <- merge(Survey_Monkey_Melt, Survey_Monkey_Question_2, by.x = "Question", by.y = "Questionsub", all.x = TRUE)
respondents <- Survey_Monkey_Merged[! is.na(Survey_Monkey_Merged$Answer),]
View(respondents)
#Merge and remove NA
Survey_Monkey_Merged <- merge(Survey_Monkey_Melt, Survey_Monkey_Question_2, by.x = "Question", by.y = "Question", all.x = TRUE)
respondents <- Survey_Monkey_Merged[! is.na(Survey_Monkey_Merged$Answer),]
#Merge and remove NA
Survey_Monkey_Merged <- merge(Survey_Monkey_Melt, Survey_Monkey_Question_2, by.x = "Question", by.y = "Question", all.x = TRUE)
respondents <- Survey_Monkey_Merged[! is.na(Survey_Monkey_Merged$Answer),]
View(respondents)
#Merge and remove NA
Survey_Monkey_Merged <- merge(Survey_Monkey_Melt, Survey_Monkey_Question_2, by.x = "Question", by.y = "Questionsub", all.x = TRUE)
respondents <- Survey_Monkey_Merged[! is.na(Survey_Monkey_Merged$Answer),]
View(Survey_Monkey_Merged)
# respondents_2 <- respondents
tmp <- data.table(respondents)
respondents <- tmp[, .(number_of_unique_answers = length(unique("Respondent ID"))), by ="Question.y"]
tmp
respondents
respondents <- tmp[, .(number_of_unique_answers = length(("Respondent ID"))), by ="Question.y"]
respondents
tmp
yes <- tmp[, .(number_of_unique_answers = length(("Respondent ID"))), by ="Question.y"]
yes
# respondents_2 <- respondents
tmp <- data.table(respondents)
tmp
#Merge and remove NA
Survey_Monkey_Merged <- merge(Survey_Monkey_Melt, Survey_Monkey_Question_2, by.x = "Question", by.y = "Questionsub", all.x = TRUE)
respondents <- Survey_Monkey_Merged[! is.na(Survey_Monkey_Merged$Answer),]
# respondents_2 <- respondents
tmp <- data.table(respondents)
yes <- tmp[, .(number_of_unique_answers = length(("Respondent ID"))), by ="Question.y"]
tmp
yes
tmp[length(("Respondent ID")))]
tmp[length(("Respondent ID"]
tmp[length"Respondent ID"]
length(tmp$`Respondent ID`)
length(group_by(tmp$`Respondent ID`)
)
View(tmp)
summarise(tmp)
summarise(tmp)
summary(tmp)
summary(tmp$Question.y)
summarise(tmp$Question.y)
unique(tmp$Question.y)
table(tmp$Question.y)
asd <- table(tmp$Question.y)
asd
yes <- tmp[, .(number_of_unique_answers = count(("Respondent ID"))), by ="Question.y"]
View(yes)
yes <- tmp[, .(number_of_unique_answers = length(("Respondent ID"))), by = tmp$Question.y]
yes
yes <- tmp[, .(number_of_unique_answers = length((tmp$`Respondent ID`))), by = tmp$Question.y]
yes <- tmp[, .(number_of_unique_answers = length((tmp$`Respondent ID`))), by = tmp$Question.y]
yes
length((tmp$`Respondent ID`))
length((tmp$`Respondent ID`))
tmp %>% count(`Respondent ID`)
tmp %>% count(`Respondent ID`, Question.y)
tmp %>% count(Question.y)
yes <- tmp[, .(number_of_unique_answers = count(tmp$Question.y))]
tmp2 <- tmp %>% count(Question.y)
#Merge and remove NA
Survey_Monkey_Merged <- merge(Survey_Monkey_Melt, Survey_Monkey_Question_2, by.x = "Question", by.y = "Questionsub", all.x = TRUE)
respondents <- Survey_Monkey_Merged[! is.na(Survey_Monkey_Merged$Answer),]
# respondents_2 <- respondents
# tmp <- data.table(respondents)
respondents <- respondents %>% count(Question.y)
tmp
yes
asd <- table(tmp$Question.y)
# respondents_2 <- respondents
# tmp <- data.table(respondents)
respondents <- respondents %>% count(Question.y)
respondents
#Merge and remove NA
Survey_Monkey_Merged <- merge(Survey_Monkey_Melt, Survey_Monkey_Question_2, by.x = "Question", by.y = "Questionsub", all.x = TRUE)
respondents <- Survey_Monkey_Merged[! is.na(Survey_Monkey_Merged$Answer),]
# respondents_2 <- respondents
# tmp <- data.table(respondents)
respondents <- respondents %>% count(Question.y)
respondents
yes <- tmp[, .(number_of_unique_answers = length(unique(tmp$`Respondent ID`))), by = tmp$Question.y]
#Merge and remove NA
Survey_Monkey_Merged <- merge(Survey_Monkey_Melt, Survey_Monkey_Question_2, by.x = "Question", by.y = "Questionsub", all.x = TRUE)
respondents <- Survey_Monkey_Merged[! is.na(Survey_Monkey_Merged$Answer),]
# respondents_2 <- respondents
tmp <- data.table(respondents)
yes <- tmp[, .(number_of_unique_answers = length(unique(tmp$`Respondent ID`))), by = tmp$Question.y]
tmp
yes
yes <- tmp[, .(number_of_unique_answers = length(unique(tmp$`Respondent ID`)), by = tmp$Question.y)]
yes
yes <- tmp[, .(number_of_unique_answers = length(unique(tmp$`Respondent ID`)), by = tmp$Question.y]
yes
#Merge and remove NA
Survey_Monkey_Merged <- merge(Survey_Monkey_Melt, Survey_Monkey_Question_2, by.x = "Question", by.y = "Questionsub", all.x = TRUE)
respondents <- Survey_Monkey_Merged[! is.na(Survey_Monkey_Merged$Answer),]
# respondents_2 <- respondents
tmp <- data.table(respondents)
yes <- tmp[, .(number_of_unique_answers = length(unique(tmp$`Respondent ID`)), by = tmp$Question.y]
yes <- tmp[, .(number_of_unique_answers = length(unique(tmp$`Respondent ID`))), by = tmp$Question.y]
yes
yes <- tmp[, .(number_of_unique_answers = count(unique(tmp$`Respondent ID`))), by = tmp$Question.y]
yes <- tmp[, .(number_of_unique_answers = count((tmp$`Respondent ID`))), by = tmp$Question.y]
#Merge and remove NA
Survey_Monkey_Merged <- merge(Survey_Monkey_Melt, Survey_Monkey_Question_2, by.x = "Question", by.y = "Questionsub", all.x = TRUE)
respondents <- Survey_Monkey_Merged[! is.na(Survey_Monkey_Merged$Answer),]
# respondents_2 <- respondents
respondents <- respondents %>% count(Question.y)
# tmp <- data.table(respondents)
# yes <- tmp[, .(number_of_unique_answers = count((tmp$`Respondent ID`))), by = tmp$Question.y]
# tmp
# yes
respondents
library(readxl)
library(reshape2)
library(data.table)
library(writexl)
library(dplyr)
Survey_Monkey <- read_excel("Data - Survey Monkey Output (Edited).xlsx", sheet = "Edited_Data")
Survey_Monkey_2 <- (Survey_Monkey)
View(Survey_Monkey)
View(Survey_Monkey_2)
col_drop <- c("Email Address", "First Name", "Last Name", "Custom Data 1")
Survey_Monkey_2 <- Survey_Monkey_2[, !names(Survey_Monkey_2) %in% col_drop]
id_variables <- colnames(Survey_Monkey_2)[1:10]
id_variables
# question_variables <- colnames(Survey_Monkey_2)[11:length()]
Survey_Monkey_Melt <- melt(Survey_Monkey_2, id = id_variables, variable.name = "Question", value.name = "Answer")
View(Survey_Monkey_Melt)
Survey_Monkey_Question <- read_excel("Data - Survey Monkey Output (Edited).xlsx", sheet = "Questions")
Survey_Monkey_Question_2 <- Survey_Monkey_Question
# colnames(Survey_Monkey_Question_2)
Survey_Monkey_Question_2 <- Survey_Monkey_Question_2[, !names(Survey_Monkey_Question_2) %in% c("Raw_Question", "Raw_Subquestion", "...3", "Question & Subquestion...6")]
Survey_Monkey_Question_2 <- rename(Survey_Monkey_Question_2, "Questionsub" = "Question & Subquestion...7")
# colnames(Survey_Monkey_Question_2)
#Merge and remove NA
Survey_Monkey_Merged <- merge(Survey_Monkey_Melt, Survey_Monkey_Question_2, by.x = "Question", by.y = "Questionsub", all.x = TRUE)
respondents <- Survey_Monkey_Merged[! is.na(Survey_Monkey_Merged$Answer),]
# respondents_2 <- respondents
respondents <- respondents %>% count(Question.y)
respondents
# tmp <- data.table(respondents)
# yes <- tmp[, .(number_of_unique_answers = count((tmp$`Respondent ID`))), by = tmp$Question.y]
# tmp
# yes
respondents %>% tally(Question.y)
library(readxl)
library(reshape2)
library(data.table)
library(writexl)
library(dplyr)
Survey_Monkey <- read_excel("Data - Survey Monkey Output (Edited).xlsx", sheet = "Edited_Data")
Survey_Monkey_2 <- (Survey_Monkey)
View(Survey_Monkey)
View(Survey_Monkey_2)
col_drop <- c("Email Address", "First Name", "Last Name", "Custom Data 1")
Survey_Monkey_2 <- Survey_Monkey_2[, !names(Survey_Monkey_2) %in% col_drop]
id_variables <- colnames(Survey_Monkey_2)[1:10]
id_variables
# question_variables <- colnames(Survey_Monkey_2)[11:length()]
Survey_Monkey_Melt <- melt(Survey_Monkey_2, id = id_variables, variable.name = "Question", value.name = "Answer")
View(Survey_Monkey_Melt)
Survey_Monkey_Question <- read_excel("Data - Survey Monkey Output (Edited).xlsx", sheet = "Questions")
Survey_Monkey_Question_2 <- Survey_Monkey_Question
# colnames(Survey_Monkey_Question_2)
Survey_Monkey_Question_2 <- Survey_Monkey_Question_2[, !names(Survey_Monkey_Question_2) %in% c("Raw_Question", "Raw_Subquestion", "...3", "Question & Subquestion...6")]
Survey_Monkey_Question_2 <- rename(Survey_Monkey_Question_2, "Questionsub" = "Question & Subquestion...7")
# colnames(Survey_Monkey_Question_2)
#Merge and remove NA
Survey_Monkey_Merged <- merge(Survey_Monkey_Melt, Survey_Monkey_Question_2, by.x = "Question", by.y = "Questionsub", all.x = TRUE)
respondents <- Survey_Monkey_Merged[! is.na(Survey_Monkey_Merged$Answer),]
# respondents_2 <- respondents
respondents <- respondents %>% count(Question.y)
respondents
# tmp <- data.table(respondents)
# yes <- tmp[, .(number_of_unique_answers = count((tmp$`Respondent ID`))), by = tmp$Question.y]
# tmp
# yes
respondents %>% tally(Question.y)
respondents %>% count(Question.y)
rename(respondents, Question = "Question.y", Count = "n")
respondents
respondents <- rename(respondents, Question = "Question.y", Count = "n")
respondents
View(Survey_Monkey_Question_2)
View(Survey_Monkey_Merged)
Survey_Monkey_Merged_2 <- merge(x = Survey_Monkey_Merged, y = respondents, by = "Question", all.x = TRUE)
View(Survey_Monkey_Merged_2)
Survey_Monkey_Merged_2 <- merge(x = Survey_Monkey_Merged, y = respondents, by = "Question.y", all.x = TRUE)
View(Survey_Monkey_Merged)
View(Survey_Monkey_Merged)
View(respondents)
# respondents_2 <- respondents
respondents <- respondents %>% count(Question.y)
Survey_Monkey_Merged_2 <- merge(x = Survey_Monkey_Merged, y = respondents, by = "Question.y", all.x = TRUE)
library(readxl)
library(reshape2)
library(data.table)
library(writexl)
library(dplyr)
Survey_Monkey <- read_excel("Data - Survey Monkey Output (Edited).xlsx", sheet = "Edited_Data")
Survey_Monkey_2 <- (Survey_Monkey)
# View(Survey_Monkey)
# View(Survey_Monkey_2)
col_drop <- c("Email Address", "First Name", "Last Name", "Custom Data 1")
Survey_Monkey_2 <- Survey_Monkey_2[, !names(Survey_Monkey_2) %in% col_drop]
id_variables <- colnames(Survey_Monkey_2)[1:10]
id_variables
# question_variables <- colnames(Survey_Monkey_2)[11:length()]
Survey_Monkey_Melt <- melt(Survey_Monkey_2, id = id_variables, variable.name = "Question", value.name = "Answer")
# View(Survey_Monkey_Melt)
Survey_Monkey_Question <- read_excel("Data - Survey Monkey Output (Edited).xlsx", sheet = "Questions")
Survey_Monkey_Question_2 <- Survey_Monkey_Question
# colnames(Survey_Monkey_Question_2)
Survey_Monkey_Question_2 <- Survey_Monkey_Question_2[, !names(Survey_Monkey_Question_2) %in% c("Raw_Question", "Raw_Subquestion", "...3", "Question & Subquestion...6")]
Survey_Monkey_Question_2 <- rename(Survey_Monkey_Question_2, "Questionsub" = "Question & Subquestion...7")
# colnames(Survey_Monkey_Question_2)
#Merge and remove NA
Survey_Monkey_Merged <- merge(Survey_Monkey_Melt, Survey_Monkey_Question_2, by.x = "Question", by.y = "Questionsub", all.x = TRUE)
respondents <- Survey_Monkey_Merged[! is.na(Survey_Monkey_Merged$Answer),]
# respondents_2 <- respondents
respondents <- respondents %>% count(Question.y)
respondents <- rename(respondents, Question = "Question.y", Count = "n")
respondents
Survey_Monkey_Merged_2 <- merge(x = Survey_Monkey_Merged, y = respondents, by = "Question.y", all.x = TRUE)
View(Survey_Monkey_Merged)
Survey_Monkey_Merged_2 <- merge(x = Survey_Monkey_Merged, y = respondents, by.x = "Question.y", by.y = "Question", all.x = TRUE)
View(Survey_Monkey_Merged_2)
respondents <- rename(respondents, Question = "Question.y", Num_distinct = "n")
library(readxl)
library(reshape2)
library(data.table)
library(writexl)
library(dplyr)
Survey_Monkey <- read_excel("Data - Survey Monkey Output (Edited).xlsx", sheet = "Edited_Data")
Survey_Monkey_2 <- (Survey_Monkey)
# View(Survey_Monkey)
# View(Survey_Monkey_2)
col_drop <- c("Email Address", "First Name", "Last Name", "Custom Data 1")
Survey_Monkey_2 <- Survey_Monkey_2[, !names(Survey_Monkey_2) %in% col_drop]
id_variables <- colnames(Survey_Monkey_2)[1:10]
id_variables
# question_variables <- colnames(Survey_Monkey_2)[11:length()]
Survey_Monkey_Melt <- melt(Survey_Monkey_2, id = id_variables, variable.name = "Question", value.name = "Answer")
# View(Survey_Monkey_Melt)
Survey_Monkey_Question <- read_excel("Data - Survey Monkey Output (Edited).xlsx", sheet = "Questions")
Survey_Monkey_Question_2 <- Survey_Monkey_Question
# colnames(Survey_Monkey_Question_2)
Survey_Monkey_Question_2 <- Survey_Monkey_Question_2[, !names(Survey_Monkey_Question_2) %in% c("Raw_Question", "Raw_Subquestion", "...3", "Question & Subquestion...6")]
Survey_Monkey_Question_2 <- rename(Survey_Monkey_Question_2, "Questionsub" = "Question & Subquestion...7")
# colnames(Survey_Monkey_Question_2)
#Merge and remove NA
Survey_Monkey_Merged <- merge(Survey_Monkey_Melt, Survey_Monkey_Question_2, by.x = "Question", by.y = "Questionsub", all.x = TRUE)
respondents <- Survey_Monkey_Merged[! is.na(Survey_Monkey_Merged$Answer),]
# respondents_2 <- respondents
respondents <- respondents %>% count(Question.y)
respondents <- rename(respondents, Question = "Question.y", Num_distinct = "n")
respondents
Survey_Monkey_Merged_2 <- merge(x = Survey_Monkey_Merged, y = respondents, by.x = "Question.y", by.y = "Question", all.x = TRUE)
same_anws <- Survey_Monkey_Merged[! is.na(Survey_Monkey_Merged$Answer),]
tmp <- same_anws[, .(Num_distinct_anws = length(unique("Respondent ID"))), by = c("Question", "Answer")]
View(same_anws)
tmp <- same_anws[, .(Num_distinct_anws = length(unique("Respondent ID"))), by = c("Question.y", "Answer")]
tmp <- same_anws[, .(Num_distinct_anws = length(unique("Respondent ID"))), by = c('Question.y', 'Answer')]
tmp2 <- data.table(same_anws)
tmp <- tmp2[, .(Num_distinct_anws = length(unique("Respondent ID"))), by = c('Question.y', 'Answer')]
tmp
tmp
tmp2
tmp2 %>% group_by(Question.y, Answer)
tmp2 %>% count(Question.y, Answer)
View(same_anws)
same_anws <- Survey_Monkey_Merged[! is.na(Survey_Monkey_Merged$Answer),]
same_anws <- same_anws %>% count(Question.y, Answer)
same_anws
same_anws <- rename(num_distinct_anws = "n")
same_anws <- rename(same_anws, num_distinct_anws = "n")
same_anws
View(Survey_Monkey_Merged_2)
View(Survey_Monkey_Merged_2)
View(same_anws)
Survey_Monkey_Merged_3 <- merge(Survey_Monkey_Merged_2, same_anws, all.x = TRUE )
View(Survey_Monkey_Merged_3)
Survey_Monkey_Merged_3 <- merge(Survey_Monkey_Merged_2, same_anws, by = c("Question.y", "Answer"), all.x = TRUE )
View(Survey_Monkey_Merged_3)
View(Survey_Monkey_Merged_2)
colnames(Survey_Monkey_Merged_3)
respondents <- Survey_Monkey_Merged[! is.na(Survey_Monkey_Merged$Answer),]
respondents <- respondents %>% count(Question.y)
respondents <- rename(respondents, Question = "Question.y", Num_distinct_respondent = "n")
respondents
Survey_Monkey_Merged_2 <- merge(x = Survey_Monkey_Merged, y = respondents, by.x = "Question.y", by.y = "Question", all.x = TRUE)
same_anws <- Survey_Monkey_Merged[! is.na(Survey_Monkey_Merged$Answer),]
same_anws <- same_anws %>% count(Question.y, Answer)
same_anws <- rename(same_anws, num_distinct_anws = "n")
same_anws
Survey_Monkey_Merged_3 <- merge(Survey_Monkey_Merged_2, same_anws, by = c("Question.y", "Answer"), all.x = TRUE )
colnames(Survey_Monkey_Merged_3)
rename(Survey_Monkey_Merged_3, Question = "Question.y", QuestionSubquestion = "Question")
same_anws <- Survey_Monkey_Merged[! is.na(Survey_Monkey_Merged$Answer),]
same_anws <- same_anws %>% count(Question.y, Answer)
same_anws <- rename(same_anws, Num_distinct_anws = "n")
same_anws
Survey_Monkey_Merged_3 <- merge(Survey_Monkey_Merged_2, same_anws, by = c("Question.y", "Answer"), all.x = TRUE )
colnames(Survey_Monkey_Merged_3)
rename(Survey_Monkey_Merged_3,
Question = "Question.y",
Question_subquestion = "Question",
Division = "Identify which division you work in.-Response",
Division_other = "Identify which division you work in.-Other (please specify)",
Position_level = "Which of the following best describes your position level?-Response",
Generation = "Which generation are you apart of?-Response",
Gender = "Please select the gender in which you identify.-Response",
Tenure_range = "Which duration range best aligns with your tenure at your company?-Response",
Employment_type = "Which of the following best describes your employment type?-Response"
)
Survey_Monkey_Merged_Final <- rename(Survey_Monkey_Merged_3,
Question = "Question.y",
Question_subquestion = "Question",
Division = "Identify which division you work in.-Response",
Division_other = "Identify which division you work in.-Other (please specify)",
Position_level = "Which of the following best describes your position level?-Response",
Generation = "Which generation are you apart of?-Response",
Gender = "Please select the gender in which you identify.-Response",
Tenure_range = "Which duration range best aligns with your tenure at your company?-Response",
Employment_type = "Which of the following best describes your employment type?-Response"
)
getwd()
write_xlsx(Survey_Monkey_Merged_Final, paste("/Survey_Monkey_Output_R.xlsx", sep = ""))
pwd
pwd()
write_xlsx(Survey_Monkey_Merged_Final)
write_xlsx(Survey_Monkey_Merged_Final, path = "./Survey_Monkey_Output_R.xlsx")
